<%-
  ppn = num_cores.blank? ? 28 : num_cores.to_i
  nodes = bc_num_slots.blank? ? 1 : bc_num_slots.to_i

  case node_type
  when "compute"
    slurm_args = [ "--nodes", "#{nodes}", "--ntasks-per-node", "#{ppn}" ]
  when "gpu"
    slurm_args = [ "--partition", "#{node_type}", "--nodes", "#{nodes}", "--ntasks-per-node", "#{ppn}", "--gpus-per-node", "1", "--gres", "gpu" ]
  end
%>
---
batch_connect:
  template: vnc
script:
  native:
  <%- slurm_args.each do |arg| %>
    - "<%= arg %>"
  <%- end %>
